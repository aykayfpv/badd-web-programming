"use strict";(self.webpackChunkpackages_lecture=self.webpackChunkpackages_lecture||[]).push([[5535],{1184:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var s=r(4041);const i={},t=s.createContext(i);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(t.Provider,{value:n},e.children)}},4446:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"web-programming/javascript/js-webworker","title":"Abschnitt 8 - Web Worker","description":"Ausf\xfchrung aufwendiger Berechnungen ohne Stocken","source":"@site/docs/web-programming/javascript/web-worker.mdx","sourceDirName":"web-programming/javascript","slug":"/js/webworker","permalink":"/badd-web-programming/docs/js/webworker","draft":false,"unlisted":false,"editUrl":"https://github.com/blutorange/badd-web-programming/tree/main/packages/lecture/docs/web-programming/javascript/web-worker.mdx","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"id":"js-webworker","slug":"/js/webworker","sidebar_position":8,"description":"Ausf\xfchrung aufwendiger Berechnungen ohne Stocken"},"sidebar":"tutorialSidebar","previous":{"title":"Abschnitt 7 - Fetch API","permalink":"/badd-web-programming/docs/js/fetch"},"next":{"title":"Abschnitt 9 - Dokumentation","permalink":"/badd-web-programming/docs/js/doc-comments"}}');var i=r(1085),t=r(1184),a=r(6279);const o={id:"js-webworker",slug:"/js/webworker",sidebar_position:8,description:"Ausf\xfchrung aufwendiger Berechnungen ohne Stocken"},d="Abschnitt 8 - Web Worker",c={},l=[];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"abschnitt-8---web-worker",children:"Abschnitt 8 - Web Worker"})}),"\n",(0,i.jsx)(n.p,{children:"JavaScript wurde traditionell f\xfcr kleine Dinge eingesetzt, um Webseiten etwas\nmehr Dynamic zu verleihen, etwa der Vergr\xf6\xdferung eines Bilds beim \xdcberfahren\nmit der Maus."}),"\n",(0,i.jsx)(n.p,{children:"Inzwischen werden auch komplexe Anwendungen als Webanwendung umgesetzt. Diese\nerfordern teilweise Berechnungen, welche l\xe4nger dauern, beispielsweise:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Der Code-Editor in der Sandbox (",(0,i.jsx)(n.a,{href:"https://microsoft.github.io/monaco-editor/",children:"monaco-editor"}),")\nmuss Code-Vorschl\xe4ge und Fehler in der Syntax berechnen."]}),"\n",(0,i.jsx)(n.li,{children:"Office 365 / Word hat einen Webworker f\xfcr Telemetry."}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://pixijs.com/",children:"PixiJS"}),", eine bekannte HTML5-Game-Engine,\n",(0,i.jsx)(n.a,{href:"https://pixijs.download/dev/docs/environment.html#WebWorkerAdapter",children:"unterst\xfctzt WebWorker"}),",\num Spiel-Logik und Berechnungen dort auszuf\xfchren."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"W\xfcrden wir diese l\xe4ngeren Berechnungen ohne WebWorker ausf\xfchren, kann das\nzur Folge haben, dass eine Webseite eine Zeit lang unbedienbar wird oder stockend\nwirkt (unresponsive)."}),"\n",(0,i.jsx)(n.p,{children:"Bei Verwendung eines Web-Worker m\xfcssen wir bedenken, dass dieser in der Regel\nvom Browser in einem separaten Thread ausgef\xfchrt und losgel\xf6st vom Main-Thread\nist. Als Folge davon steht die DOM-API nicht zur Verf\xfcgung und es kann nicht\ndirekt auf HTML-Elemente oder Funktionen aus dem Main-Thread zugegriffen werden."}),"\n",(0,i.jsx)(n.p,{children:"Prinzipiell ist ein Web-Worker nur eine JavaScript-Datei, welche auf eine\nspezielle Art geladen wird:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'// Starten des Workers\nconst worker = new Worker("https://example.com/my-worker.js");\n\n// ...\n\n// Beenden des Workers\nworker.terminate();\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Um mit dem Worker zu kommunizieren und Daten auszutauschen, m\xfcssen sogenannte\n",(0,i.jsx)(n.code,{children:"Message"})," verwendet werden. Eine ",(0,i.jsx)(n.code,{children:"Message"})," ist lediglich nur ein JavaScript-Wert,\nder an den Worker \xfcbertragen werden soll."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'worker.postMessage({type: "computePlayerPathThroughLabyrinth"});\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Um im Worker-JavaScript ",(0,i.jsx)(n.code,{children:"Message"})," zu empfangen, m\xfcssen wir einen Event-Listener\nregistrieren."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'globalThis.addEventListener("message", event => {\n  console.log(event.data);\n});\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Analog k\xf6nnen wir einen Event-Listener auf den Worker registrieren, um ",(0,i.jsx)(n.code,{children:"Message"}),"\nvon diesem zu empfangen:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'worker.addEventListener("message", event => {\n  console.log(event.data);\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:"Hier findet sich noch ein Beispiel in der Sandbox, wo ein Worker verwendet\nwird, um Primzahlen zu berechnen. Durch den Worker bleibt die Seite responsiv:"}),"\n",(0,i.jsx)("p",{children:(0,i.jsx)(a.A,{to:"/sandbox?snippet=worker",target:"_blank",rel:"noopener noreferrer",children:"Worker-Beispiel mit Primzahlenberechnung"})}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["Beim Senden von ",(0,i.jsx)(n.code,{children:"Message"})," wird der sogenannte\n",(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm",children:"strukturelle Klon-Mechanismus"}),"\nauf das gesendete Objekte angewandt. Vereinfach gesagt bedeutet das, dass\neine Kopie von dem Objekt erstellt wird, sodass die beiden Seiten getrennte\nKopien des Objekts besitzen."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'const data = {type: "computePlayerPathThroughLabyrinth"};\nworker.postMessage(data);\ndata.hint = "Look backwards";\n'})}),(0,i.jsxs)(n.p,{children:["Die \xc4nderungen des ",(0,i.jsx)(n.code,{children:"data"}),"-Objekte nach dem Senden der Nachricht hat keine\nAuswirkung mehr auf die Daten, welcher der Worker empf\xe4ngt, da eine Kopie von\ndem Objekt erstellt wurde."]})]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);