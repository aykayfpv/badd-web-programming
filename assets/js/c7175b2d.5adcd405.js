"use strict";(self.webpackChunkpackages_lecture=self.webpackChunkpackages_lecture||[]).push([[5342],{40765:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/clickjacking-6d74687f7cd3b108e1caf9cbc43d1c57.svg"},64180:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>d,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"web-programming/security/security","title":"Kapitel 8 - Sicherheit","description":"Grundlegende Konzepte der Sicherheit von Webseiten.","source":"@site/docs/web-programming/security/index.mdx","sourceDirName":"web-programming/security","slug":"/security","permalink":"/badd-web-programming/docs/security","draft":false,"unlisted":false,"editUrl":"https://github.com/blutorange/badd-web-programming/tree/main/packages/lecture/docs/web-programming/security/index.mdx","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"id":"security","slug":"/security","sidebar_position":8,"description":"Grundlegende Konzepte der Sicherheit von Webseiten."},"sidebar":"tutorialSidebar","previous":{"title":"Abschnitt 5 - Standardisierung (Native Komponenten)","permalink":"/badd-web-programming/docs/framework/web-components"},"next":{"title":"\xdcbungsaufgaben","permalink":"/badd-web-programming/docs/exercise"}}');var s=i(31085),t=i(71184),a=i(16279);const d={id:"security",slug:"/security",sidebar_position:8,description:"Grundlegende Konzepte der Sicherheit von Webseiten."},l="Kapitel 8 - Sicherheit",c={},h=[{value:"HTTPS",id:"https",level:2},{value:"Header",id:"header",level:2},{value:"CORS",id:"cors",level:3},{value:"HSTS",id:"hsts",level:3},{value:"CSP",id:"csp",level:3},{value:"XSS",id:"xss",level:2},{value:"Szenario",id:"szenario",level:3},{value:"Nonce",id:"nonce",level:3},{value:"HTTP-Only-Cookies",id:"http-only-cookies",level:3}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"kapitel-8---sicherheit",children:"Kapitel 8 - Sicherheit"})}),"\n",(0,s.jsx)(n.p,{children:"Mit wachsender Popularit\xe4t des Internets w\xe4chst auch die Bedeutung, dessen\nNutzung abzusichern. Sicherheit ist ein komplexes Thema, was wir im Rahmen\ndieses Moduls nicht umfassend behandeln k\xf6nnen. Stattdessen wollen wir uns diesem\nletzten Kapitel gezielt einige ausgew\xe4hlte Aspekte anschauen, die wir bei der\nEntwicklung von Webseiten bedenken und beachten sollten."}),"\n",(0,s.jsx)(n.h1,{id:"online-ressourcen",children:"Online-Ressourcen"}),"\n",(0,s.jsx)(n.p,{children:"Eine bedeutsame Ressource ist OWASP (Open Worldwide Application Security Project).\nOWASP ist eine Online-Community rund um das Thema Sicherheit. Sie stellen\nauf Ihrer Webseite verschiedene Informationen bereit, darunter etwa:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://owasp.org/www-project-top-ten/",children:"https://owasp.org/www-project-top-ten/"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Top 10 Web Application Security Risks"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://owasp.org/www-community/attacks/",children:"https://owasp.org/www-community/attacks/"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Liste bekannter Angriffsszenarien"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://cheatsheetseries.owasp.org/index.html",children:"https://cheatsheetseries.owasp.org/index.html"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Informationen und Anleitungen zum Vermeiden bekannter Sicherheitsprobleme."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["In Bezug auf Software-Schwachstellen und Sicherheitsl\xfccken ist auch die\n",(0,s.jsx)(n.a,{href:"https://nvd.nist.gov/",children:"NVD - National Vulnerability Database"})," erw\xe4hnenswert.\nDort werden bekannte Schwachstellen von Software gepflegt und k\xf6nnen\n",(0,s.jsx)(n.a,{href:"https://nvd.nist.gov/vuln/search",children:"durchsucht"})," werden. Diese Liste k\xf6nnen wir auch\nbeispielsweise beim Build-Step verwenden, um die Abh\xe4ngigkeiten unserer Webapp\nnach bekannten Sicherheitsl\xfccken zu durchsuchen. 2 Begrifflichkeiten, die wir\nbei Verwendung von NVD kennen sollten:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["CWE (Common Weakness Enumeration) \u2014 ID, die bekannten Arten Schwachstellen in\nSoftware gegeben wird. Beispielsweise ist ",(0,s.jsx)(n.a,{href:"https://cwe.mitre.org/data/definitions/79.html",children:"CWE-79"}),"\ndie ID f\xfcr XSS (Cross-site Scripting, siehe unten)."]}),"\n",(0,s.jsxs)(n.li,{children:["CVE (Common Vulnerabilities and Exposures) \u2014 ID f\xfcr konkrete Probleme\nin einer bestimmten Software und Version. Beispielsweise ist\n",(0,s.jsx)(n.a,{href:"https://www.cve.org/CVERecord?id=CVE-2022-31160",children:"CVE-2022-31160"})," eine konkrete\nXSS-Schwachstelle von ",(0,s.jsx)(n.a,{href:"https://jqueryui.com/",children:"jQueryUI"})," bei Verwendung des\nCheckbox-Auwahl-Widgets."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Weitere Datenbanken f\xfcr CVE sind etwa ",(0,s.jsx)(n.a,{href:"https://www.cve.org/",children:"cve.org"}),"\noder die ",(0,s.jsx)(n.a,{href:"https://security.snyk.io/vuln",children:"Snyk Vulnerability Database"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"https",children:"HTTPS"}),"\n",(0,s.jsxs)(n.p,{children:["HTTPS hatten wir bereits als abgesichertes Protokoll im Kapitel zu HTTP kennengelernt.\nProduktive Webseiten sollten wir als ersten Schritt immer per HTTPS betreiben.\nFalls notwendig, k\xf6nnen wir zudem noch eine Form der Ende-Zu-Ende-Verschl\xfcsselung\nanwenden, falls es sich um Daten handelt, die der Server nicht lesen k\xf6nnen muss.\nF\xfcr weitere Informationen sieh hierzu den Abschnitt\n",(0,s.jsx)(a.A,{to:"/docs/http/protocol/#https--tls",rel:"noopener noreferrer",children:"HTTP / TLS"}),"\naus dem vorigen Kapitel."]}),"\n",(0,s.jsx)(n.h2,{id:"header",children:"Header"}),"\n",(0,s.jsx)(n.p,{children:"Webbrowser unterst\xfctzen verschiedene HTTP-Header, die wir verwenden k\xf6nnen, um die\nSicherheit unserer Webseite zu erh\xf6hen."}),"\n",(0,s.jsx)(n.h3,{id:"cors",children:"CORS"}),"\n",(0,s.jsxs)(n.p,{children:["Standardm\xe4\xdfig erlauben Browser es nicht, dass eine Webseite bzw. unser JavaScript-Code\nauf Ressourcen und URLs einer anderen Webseite zugreift. Falls ein Server das erlauben\nm\xf6chte, kann er den Header ",(0,s.jsx)(n.code,{children:"Access-Control-Allow-Origin"})," setzen, siehe den\nAbschnitt\n",(0,s.jsx)(a.A,{to:"/docs/http/protocol/#origin",rel:"noopener noreferrer",children:"Origin"}),"\naus dem Kapitel zu HTTP."]}),"\n",(0,s.jsx)(n.p,{children:"Erinnern wir uns \u2014 Beispielsweise schl\xe4gt folgendes JavaScript fehl:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'await fetch("https://example.com")\n'})}),"\n",(0,s.jsx)(n.p,{children:"Warum gibt es aber diese Einschr\xe4nkung? Was w\xfcrde passieren, wenn wir per JavaScript\nHTTP-Requests an jede andere Webseite stellen d\xfcrften? Um das zu verstehen,\nbetrachten wir 2 Szenarien."}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"Im folgenden nutzen wir ausgedachte Webseitennamen als Beispiel. Bitte trotzdem\nnicht die Adressen im Browser aufrufen!"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Session-Cookie"})}),"\n",(0,s.jsx)(n.p,{children:"Damit der Nutzer sich nicht bei jedem Mal neu anmelden muss, k\xf6nnen wir einen\nSession-Cookie verwenden. Diesen sendet der Browser bei jedem Aufruf an die\nWebseite automatisch mit."}),"\n",(0,s.jsxs)(n.p,{children:["Nehmen wir nun an, die Shopping-Webseite ",(0,s.jsx)(n.code,{children:"suppazon.de"})," erlaubt die Aufgabe\neiner Bestellung \xfcber das folgende POST-Request:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'POST https://suppazon.de/order HTTP/1.1\nCookie: spznfbgid=X00-8888999-1111222:3335555666\nContent-Type: application/json\n{\n  "product_id": "web_programming_basics",\n  "amount": "1",\n  "shipping_address": "01234 Musterstand, Musterstr. 42a",\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Browser sind heutzutage Multi-Tab-basiert. Nutzer k\xf6nnen gleichzeitig bei Suppazon\nangemeldet sein und nebenbei in einem anderen Tab nach weiteren Informationen\nzum Produkt suchen."}),"\n",(0,s.jsxs)(n.p,{children:["Nun besucht der Nutzer aus Versehen die b\xf6sartige Webseite ",(0,s.jsx)(n.code,{children:"https://check48.de/"}),".\ncheck48 k\xf6nnte nun per JavaScript ein HTTP-Request an ",(0,s.jsx)(n.code,{children:"suppazon.de"})," stellen\nund damit eine Bestellung im Namen des Nutzers ausl\xf6sen, potentiell mit ge\xe4nderter\nLieferadresse. Das funktioniert, weil der Browser automatisch das Session-Cookie mitsendet."]}),"\n",(0,s.jsx)(n.p,{children:"Da JavaScript im Hintergrund l\xe4uft, w\xfcrde der Nutzer in dem Moment das nicht einmal bemerken."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Ressourcen im Intranet"})}),"\n",(0,s.jsx)(n.p,{children:"Viele Firmen nutzen ein sogenanntes Intranet. Ein Intranet ist ein Subnetzwerk,\nwelches nur f\xfcr Rechner zug\xe4nglich sind, die sich in der Firma befinden. Im Intranet\nk\xf6nnten etwa firmeninterne Dokumente abgelegt sein. Das Intranet ist vom\nInternet getrennt, sodass ausgeschlossen ist, dass \xfcber das Internet Personen\nvon au\xdferhalb auf diese Dokumente zugreifen k\xf6nnen."}),"\n",(0,s.jsx)(n.p,{children:"Anders herum ist es aber f\xfcr Rechner im Intranet der Firma m\xf6glich, auf das\nInternet zuzugreifen (sonst w\xe4re heutzutage kaum noch ein Arbeiten m\xf6glich)."}),"\n",(0,s.jsxs)(n.p,{children:["Nehmen wir nun an, Max Mustermann arbeitet als Produkt-Manager in der Firma\n",(0,s.jsx)(n.code,{children:"Mars Mobile"}),". Die Firma hat ein Intranet, in dem es unter ",(0,s.jsx)(n.code,{children:"https://mmobile.intra.de/chat"}),"\nauch einen internen Chat f\xfcr die Mitarbeiter gibt."]}),"\n",(0,s.jsxs)(n.p,{children:["Max sucht jetzt nach den technischen Daten des neu erschienen Produkts\n",(0,s.jsx)(n.code,{children:"Merry Mobilfon 3"}),". Aus Versehen landet er dabei auf der b\xf6sartigen Webseite\n",(0,s.jsx)(n.code,{children:"https://ur-anus.de/product-overview"}),". Jetzt k\xf6nnte diese Webseite per JavaScript\nein HTTP-Request an ",(0,s.jsx)(n.code,{children:"https://mmobile.intra.de/chat"})," stellen und somit die\nbisher geschriebenen Nachrichten aus dem firmeninternen Chat abrufen."]}),"\n",(0,s.jsx)(n.p,{children:"Das funktioniert, weil der Rechner und Browser von Max sowohl auf das firmeninterne\nIntranet als auch auf das weltweite Internet Zugriff hat. M\xf6gliche Einschr\xe4nkung\nan Cookie sind in diesem Fall irrelevant, weil die Absicherung hier nur darauf\nbasiert, dass das Intranet nicht von au\xdferhalb zug\xe4nglich ist."}),"\n",(0,s.jsx)(n.h3,{id:"hsts",children:"HSTS"}),"\n",(0,s.jsxs)(n.p,{children:["HSTS steht f\xfcr ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Strict-Transport-Security",children:"HTTPS Strict-Transport-Security"}),"\nund bezieht sich auf den HTTP-Header ",(0,s.jsx)(n.code,{children:"Strict-Transport-Security"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Setzt ein Server diesen Header, erlaubt der Browser nur den Zugriff per HTTPS.\nZudem erzwingt der Browser, dass HTTPS korrekt konfiguriert und das Zertifikat\ng\xfcltig ist. Ist das nicht der Fall, verweigert der Browser den Zugriff."}),"\n",(0,s.jsx)(n.p,{children:"Dies war in der Vergangenheit besonders wichtig, als Webseiten ohne HTTPS noch\nh\xe4ufiger anzutreffen waren. Nutzt eine Webseite kein HTTPS, war es f\xfcr Browser damit\nnicht m\xf6glich herauszufinden, ob die Webseite einfach kein HTTPs unterst\xfctzt;\noder ob die HTTPS-Verschl\xfcsselung durch einen Angreifer ausgehebelt wurde."}),"\n",(0,s.jsx)(n.p,{children:"Inzwischen zeigen viele Browser bereits standardm\xe4\xdfig eine Warnung, wenn wir\nversuchen, eine Webseite per HTTP aufzurufen. Dennoch ist der HSTS-Header ein\nsinnvolles Mittel, was keine Nachteile hat."}),"\n",(0,s.jsx)(n.h3,{id:"csp",children:"CSP"}),"\n",(0,s.jsxs)(n.p,{children:["CSP stellt f\xfcr ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP",children:"Content-Security-Policy"}),"\nund bezieht sich auf den ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy",children:"gleichnamigen HTTP-Header"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Mit diesem Header k\xf6nnen wir eine gro\xdfe Menge von sicherheitsbezogene Einstellungen\nf\xfcr unserer vornehmen. Abh\xe4ngig vom Inhalt des Headers deaktivieren Browser\ndann bestimmte Funktionen auf der Webseite."}),"\n",(0,s.jsx)(n.p,{children:"Beispielsweise k\xf6nnten wir folgende Policy im CSP-Header definieren:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Content-Security-Policy: frame-ancestors 'none';\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Wir verbieten damit, dass unsere Webseite \xfcber\n",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/iframe",children:(0,s.jsx)(n.code,{children:"<iframe>"})}),"\nin andere Webseiten eingebunden wird. Damit verhindern wir zum Beispiel ein\nAngriffsszenario bekannt als\n",(0,s.jsx)(n.a,{href:"https://owasp.org/www-community/attacks/Clickjacking",children:"Clickjacking"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Beispielsweise k\xf6nnte eine b\xf6sartige Webseite unseren Webshop als IFrame einbinden,\nper CSS unsichtbar machen und so positionieren, dass der ",(0,s.jsx)(n.code,{children:"Account l\xf6schen"}),"-Button\ndirekt \xfcber dem ",(0,s.jsx)(n.code,{children:"Gratis-Handy"}),"-Button der Webseite liegt. \xdcber die CSS-Eigenschaft\n",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events",children:"pointer-events: none"}),"\nkann die b\xf6sartige Webseite daf\xfcr sorgen, dass Klicks auf den ",(0,s.jsx)(n.code,{children:"Gratis-Handy"}),"-Button\nignoriert werden und direkt auf den darunterliegenden unsichtbaren IFrame weitergeleitet\nwerden."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Beispiel f\xfcr Clickjacking mit einer Webseite, die einen Button \xfcber einen unsichtbaren IFrame legt.",src:i(40765).A+"",width:"621",height:"371"})}),"\n",(0,s.jsxs)(n.p,{children:["Viele weitere Policies f\xfcr den ",(0,s.jsx)(n.code,{children:"Content-Security-Policy"}),"-Header finden sich etwa bei\n",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy",children:"MDN web docs - CSP"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"xss",children:"XSS"}),"\n",(0,s.jsx)(n.p,{children:"Um unser Sinn f\xfcr Sicherheit zu sch\xe4rfen, wollen wir uns noch eine bekannte\nGefahren anschauen, die unsere Webseite unsicher machen k\xf6nnen."}),"\n",(0,s.jsxs)(n.p,{children:["XSS steht f\xfcr ",(0,s.jsx)(n.a,{href:"https://owasp.org/www-community/attacks/xss/",children:"Cross-site Scripting"}),"\nund bezieht sich allgemein auf Szenarien, wo ein b\xf6sartiger Angreifer JavaScript\nerstellt und auf unserer Webseite ausf\xfchrt."]}),"\n",(0,s.jsx)(n.p,{children:"Schafft der Angreifer das, kann dieser per JavaScript auf alle Informationen\nauf der aktuellen Webseite zugreifen. Gerade heutzutage, wo viele Webseiten\nclientseitige UI-Frameworks einsetzen und somit gro\xdfe Teile der Logik und\nDaten im Browser sind, stellt das ein Sicherheitsrisiko dar."}),"\n",(0,s.jsxs)(n.p,{children:["Neben dem HTML selber kann der Angreifer per JavaScript auch zugreifen auf\nbeispielsweise ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/Cookies",children:"Cookies"}),",\n",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API",children:"Local und Session Storage"}),"\noder ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API",children:"Indexed DB"}),".\nOder der Angreifer k\xf6nnte per ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API",children:"fetch"}),"\nHTTP-Requests innerhalb unserer Shopping-Webseite stellen und Bestellungen\nauszul\xf6sen. Der oben besprochen CORS-Schutz ist hier nicht mehr wirksam,\nda das JavaScript im Kontext unserer Webseite ausgef\xfchrt wird."]}),"\n",(0,s.jsx)(n.h3,{id:"szenario",children:"Szenario"}),"\n",(0,s.jsx)(n.p,{children:"Wie k\xf6nnte es nun passieren, dass ein Angreifer JavaScript in unsere Webseite\ninjizieren und ausf\xfchren kann? Es gibt hier sehr viele M\xf6glichkeiten, die\nwir unm\xf6glich alle auflisten k\xf6nnen. Teilweise sind diese auch spezifisch f\xfcr\nden konkreten Anwendungsfall der Webseite. Allgemein k\xf6nnen wir aber sagen,\ndass XSS-Angriff nicht selten dadurch entstehen, dass wir als Programmierer\nunachtsam waren oder eingegebenen Daten vertraut haben, ohne diese zu validieren."}),"\n",(0,s.jsx)(n.p,{children:"Nehmen wir beispielsweise an, wir haben eine Webseite erstellt, wo die \xdcberschrift\n\xfcber einen URL-Parameter ge\xe4ndert werden kann:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'// Script f\xfcr eine Webseite, wo es ein <h1>-Element gibt.\nconst url = new URL(location.href);\nconst heading = document.querySelector("h1");\nheading.innerHTML = url.searchParams.get("title");\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Dann k\xf6nnen wir etwa mit dem Aufruf ",(0,s.jsx)(n.code,{children:"https://example.com?title=Hallo%20Welt"}),"\nden Text der \xdcberschrift auf ",(0,s.jsx)(n.code,{children:"Hallo Welt"})," \xe4ndern."]}),"\n",(0,s.jsx)(n.p,{children:"Wir k\xf6nnen sogar die Schriftfarbe \xe4ndern, wenn wir die Seite aufrufen mit"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"# title = <span style='color:green'>Hallo Welt</span>\nhttps://example.com?title=%3Cspan%20style%3D'color%3Agreen'%3EHallo%20Welt%3C%2Fspan%3E\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Erkennt jemand schon das Problem? Wir wollten nicht nur reinen Text erlauben, sondern\nden Text auch formatierbar machen. Daher haben wir ",(0,s.jsx)(n.code,{children:"heading.innerHTML = ..."}),"\nverwendet, damit per HTML der Text formatiert werden kann. Leider haben wir\ndamit aber Angreifer T\xfcren und Angeln f\xfcr XSS ge\xf6ffnet. Der Angreifer braucht\nlediglich ein ",(0,s.jsx)(n.code,{children:"<script>alert('hacked')<\/script>"})," einzuf\xfcgen, um JavaScript\nausf\xfchren zu k\xf6nnen. Sendet der Link einer anderen Person einen entsprechenden\nLink und klickt diese Person auf den Link, kann der Angriff damit potentiell\ndas Konto dieser Person \xfcbernehmen."]}),"\n",(0,s.jsxs)(n.p,{children:["Um dieses Angriffsszenario zu verhindern, k\xf6nnten wir etwa ",(0,s.jsx)(n.code,{children:"<script>"}),"-Elemente\naus dem Wert des ",(0,s.jsx)(n.code,{children:"title"}),"-Parameters herausfiltern. Dieses Vorgehen nennt\nsich ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/HTML_sanitization",children:"Sanitization"}),". Zwar\nist das prinzipiell m\xf6glich, aber schwer richtig zu machen. HTML bietet\nnoch viele weitere M\xf6glichkeiten, JavaScript auszuf\xfchren, z.B. Attribute\nwie ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Element/click_event",children:"onclick"}),".\nSelbst ein Bild kann ein GET-Request ausl\xf6sen:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<span style="background-image: url(...)"></span>\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Besser w\xe4re es, die Business-Anforderung zu pr\xfcfen. Is es wirklich notwendig\nist, dass beim Aufruf der Webseite \xfcber URL-Parameter formatierten Text zu \xfcbergeben?\nFalls nicht, k\xf6nnen wir statt ",(0,s.jsx)(n.code,{children:"heading.innerHTML"})," die Eigenschaft ",(0,s.jsx)(n.code,{children:"heading.textContent"}),"\nverwenden, um dieses Problem g\xe4nzlich zu umgehen."]}),"\n",(0,s.jsx)(n.h3,{id:"nonce",children:"Nonce"}),"\n",(0,s.jsxs)(n.p,{children:["Eine weitere M\xf6glichkeit, um die F\xe4higkeit eines Angreifers einzuschr\xe4nken, JavaScript\nauszuf\xfchren, stellt der sogenannte ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Global_attributes/nonce",children:"Nonce-Mechanismus"})," dar."]}),"\n",(0,s.jsx)(n.p,{children:"Vereinfacht gesprochen handelt es sich damit um eine vom Server generierte ID f\xfcr JavaScript.\nNur JavaScript, welches die korrekte ID hat, wird vom Browser ausgef\xfchrt."}),"\n",(0,s.jsx)(n.p,{children:"Konkret ist der Ablauf wie folgt. Der Server generiert bei jedem Aufruf unserer\nWebseite eine zuf\xe4llige ID und sendet diese in der HTTP-Response zur\xfcck:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"HTTP 1.1 200 OK\nContent-Security-Policy: script-src 'nonce-8IBTHwOdqNKAWeKl7plt8g=='\nContent-Type: text/html\n<!DOCTYPE html>\n<html>\n  <head>\n    <script nonce=\"8IBTHwOdqNKAWeKl7plt8g==\">...<\/script>\n  </head>\n  <body>\n    ...\n  </body>\n</html>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Jedes ",(0,s.jsx)(n.code,{children:"<script>"}),"-Element muss dann diese Nonce enthalten, damit der Browser\ndie Ausf\xfchrung erlaubt. Damit l\xe4sst sich auch unser obiges Szenario verhindern.\nDer Angreifer kann in der URL ",(0,s.jsx)(n.code,{children:"https://example.com?title=..."})," zwar immer noch\nein ",(0,s.jsx)(n.code,{children:"<script>"})," einf\xfcgen, dieses wird aber vom Browser aufgrund der fehlenden\nNonce nicht mehr ausgef\xfchrt. Da der Server bei jedem Aufruf eine neue Nonce\nzuf\xe4llig generiert, ist es f\xfcr den Angreifer nicht m\xf6glich, die Nonce\nherauszufinden."]}),"\n",(0,s.jsx)(n.h3,{id:"http-only-cookies",children:"HTTP-Only-Cookies"}),"\n",(0,s.jsxs)(n.p,{children:["Wir sollten nat\xfcrlich immer verhindern, dass ein Angreifer JavaScript ausf\xfchren kann.\nZus\xe4tzlich k\xf6nnen wir aber auch noch Ma\xdfnahmen ergreifen, um den Impakt eines\nXSS-Angriffs zu verringern. Markieren wir sicherheitsrelevante Cookie wie\nSession-Cookies als ",(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/Security/Practical_implementation_guides/Cookies#httponly",children:"HttpOnly"}),",\nerlaubt der Browser nicht mehr den Zugriff per JavaScript."]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},71184:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>d});var r=i(14041);const s={},t=r.createContext(s);function a(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);